

<!DOCTYPE html>
<html lang="es_ES">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    

    

    <title>驴Por qu茅 no ves fantasmas en galeras?</title>

    
    <meta content="/blog-test/img/ico/favicon.png" itemprop="image">
    <meta property="og:image" content="/blog-test/img/ico/favicon.png">
    <link rel="apple-touch-icon" href="/blog-test/img/ico/favicon.png">
    <link rel="icon" href="/blog-test/img/ico/favicon.ico" />
    <link rel="shortcut icon" href="/blog-test/img/ico/favicon.ico" />

    
    <meta name="theme-color" content="#3273dc">

    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,700" rel="stylesheet">
    <!-- Bulma -->
    <link rel="stylesheet" href="/blog-test/css/bulma.min.css" />

    <!-- Font awesome -->
    <link rel="stylesheet" href="/blog-test/css/fontawesome.min.css" />

    <!-- Custom styles for this template -->
    <link rel="stylesheet" href="/blog-test/css/main.min.css" />
  </head>

  <body>
    <div class="page-container">
      <div class="content-wrapper">
        
<!-- Navigation bar -->
<nav class="navbar is-link" role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a class="navbar-item" href="/blog-test/es/">
      <i class="fas fa-terminal navbar-icon"></i>
      <span class="is-size-4">Another engineer web</span>
    </a>

    <a role="button" class="navbar-burger burger" aria-label="menu" aria-expanded="false" data-target="navbar">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div>

  <div id="navbar" class="navbar-menu">
    <div class="navbar-end">
      <a class="navbar-item" href="/blog-test/es/">
        <span class="icon">
          <i class="fas fa-bars"></i>
        </span>
        <span>Blog</span>
      </a>
      <a class="navbar-item" href="/blog-test/es/publicaciones/">
        <span class="icon">
          <i class="fas fa-file-alt"></i>
        </span>
        <span>Publicaciones</span>
      </a>
      <a class="navbar-item" href="/blog-test/es/sobre_mi/">
        <span class="icon">
          <i class="fas fa-info"></i>
        </span>
        <span>Sobre mi</span>
      </a>
      <div class="navbar-item has-dropdown is-hoverable">
        <a class="navbar-link">
          <span class="icon">
            <i class="fas fa-flag"></i>
          </span>
          <span>Idioma</span>
        </a>

        <div class="navbar-dropdown">
          
            <a class="navbar-item" href="/blog-test/en/blog/2019-05-12-why-dont-you-see-ghosts-in-galeras/">
              吼 English
            </a>
          
            <a class="navbar-item" href="/blog-test/es/blog/2019-05-12-por-que-no-ves-fantasmas-en-galeras/">
               Espa帽ol
            </a>
          
        </div>
      </div>
    </div>
  </div>
</nav>


        <noscript>
          <p class="enable-js">Active <i>JavaScript</i> en su navegador para una mejor experiencia.</p>
        </noscript>

        <div class="container">
          
<!-- START ARTICLE FEED -->
<section class="articles">
  <div class="column is-8 is-offset-2">
    <div class="card article">
      <div class="card-content">
        <div>
  
    <p class="title has-text-centered">驴Por qu茅 no ves fantasmas en galeras?</p>
  
  <p class="subtitle is-6 has-text-centered">mayo 12, 2019</p>
  <div class="tags has-addons level-item">
    
      <span class="tag is-rounded is-info">MySQL</span>
    
      <span class="tag is-rounded is-info">Cambios de esquema</span>
    
    <span class="tag">7 min de lectura</span>
  </div>
</div>
<br>
<div class="content has-text-justified article-body">
  <p>El desarrollo de <em>software</em> implica a veces cambios que afectan al modelo de datos pero dichas modificaciones tienen una serie de problem谩ticas como la incapacidad de parar el sistema o la volumetr铆a de los datos a reorganizar.</p>

<p>En este <em>post</em> quiero hablar sobre las herramientas existentes para el cambio de esquema de base de datos en MySQL, que
limitaciones tienen dichas herramientas si se usa <code>Galera</code> para la replicaci贸n y como he adaptado <code>gh-ost</code>, la herramienta de cambios de esquema de GitHub, para poder usarlo con <code>Galera</code>.</p>

<h3 id="cambios-de-esquemas">Cambios de esquemas</h3>

<p>En MySQL es posible realizar cambios de base de datos de dos formas principalmente:</p>

<ul>
<li>Mediante la operaci贸n <code>ALTER</code> de MySQL; es la forma m谩s sencilla pero no permite abortar el proceso en caso de necesidad y exceptuando de ciertas operaciones, impide el uso concurrente de la tabla a modificar durante el proceso.</li>
<li>Mediante el uso de
herramientas de terceros que permiten un mayor control del proceso aunque con ciertas restricciones. Algunas
de estas herramientas pueden ser <a href="https://www.percona.com/doc/percona-toolkit/LATEST/pt-online-schema-change.html">pt-osc</a>, <a href="https://github.com/facebookincubator/OnlineSchemaChange">OnlineSchemaChange</a> o <a href="https://github.com/github/gh-ost">gh-ost</a>.</li>
</ul>

<p>Dichos dos m茅todos son tambi茅n aplicables si se usa <code>Galera</code> aunque, debido a que sigue un enfoque <em>maestro-maestro</em>, tiene algunas peculiaridades para aplicar cambios de base de datos, tanto mediante las operaciones proporcionadas por MySQL como por las herramientas de terceros.</p>

<h3 id="galera">Galera</h3>

<p><code>Galera</code> es un <em>plug-in</em> para <em>InnoDB</em> que permite realizar una replicaci贸n s铆ncrona multi-maestro. Este enfoque permite, a diferencia de la replicaci贸n normal de MySQL, que todos los nodos del grupo tengan los mismos datos y, por tanto, aplicar escrituras en todos los nodos del grupo sacrificando algo de rendimiento.</p>

<div class="columns"> <div class="column is-8-mobile is-offset-2-mobile is-6-tablet is-offset-3-tablet"> <div class="post-image-container"> <div class="image post-image"> <div class="lazy-hide lazy-container"> <img alt="Replicaci贸n con Galera" class="lazy lazy-blur" data-srcset="/blog-test/img/blog/2019-05-12-why-dont-you-see-ghosts-in-galeras/galera_replication.190px.png 190w, /blog-test/img/blog/2019-05-12-why-dont-you-see-ghosts-in-galeras/galera_replication.480px.png 480w, /blog-test/img/blog/2019-05-12-why-dont-you-see-ghosts-in-galeras/galera_replication.674px.png 1348w, /blog-test/img/blog/2019-05-12-why-dont-you-see-ghosts-in-galeras/galera_replication.836px.png 4180w, /blog-test/img/blog/2019-05-12-why-dont-you-see-ghosts-in-galeras/galera_replication.975px.png 4875w, /blog-test/img/blog/2019-05-12-why-dont-you-see-ghosts-in-galeras/galera_replication.1109px.png 5545w" data-src="/blog-test/img/blog/2019-05-12-why-dont-you-see-ghosts-in-galeras/galera_replication.190px.png" src="/blog-test/img/blog/2019-05-12-why-dont-you-see-ghosts-in-galeras/galera_replication.preview.png" /> </div> <noscript> <div class="lazy-container"> <img alt="Replicaci贸n con Galera" class="" srcset="/blog-test/img/blog/2019-05-12-why-dont-you-see-ghosts-in-galeras/galera_replication.190px.png 190w, /blog-test/img/blog/2019-05-12-why-dont-you-see-ghosts-in-galeras/galera_replication.480px.png 480w, /blog-test/img/blog/2019-05-12-why-dont-you-see-ghosts-in-galeras/galera_replication.674px.png 1348w, /blog-test/img/blog/2019-05-12-why-dont-you-see-ghosts-in-galeras/galera_replication.836px.png 4180w, /blog-test/img/blog/2019-05-12-why-dont-you-see-ghosts-in-galeras/galera_replication.975px.png 4875w, /blog-test/img/blog/2019-05-12-why-dont-you-see-ghosts-in-galeras/galera_replication.1109px.png 5545w" src="/blog-test/img/blog/2019-05-12-why-dont-you-see-ghosts-in-galeras/galera_replication.190px.png" /> </div> </noscript> </div> <div class="image-caption">Replicaci贸n con Galera. Imagen de <a href="https://severalnines.com/resources/tutorials/galera-cluster-mysql-tutorial">severalnines</a></div> </div>  </div> </div>

<p>Los cambios de esquema son <a href="https://galeracluster.com/library/documentation/schema-upgrades.html">operaciones especiales</a> en <code>Galera</code>, dado que modifican la base de datos y son no-transaccionales. <code>Galera</code> cuenta con dos modos para aplicar cambios de base de datos mediante la operaci贸n <code>ALTER</code>:</p>

<ul>
<li><strong>TOI</strong><sup class="footnote-ref" id="fnref-1"><a href="#fn-1">1</a></sup> son cambios de esquema realizados en todos los nodos del grupo en la misma secuencia de orden total, evitando que otras transacciones se apliquen durante la operaci贸n.</li>
<li><strong>RSU</strong><sup class="footnote-ref" id="fnref-2"><a href="#fn-2">2</a></sup> son cambios de esquema que se ejecutan localmente, afectando s贸lo al nodo en el que se ejecutan. Los cambios no se replican al resto del grupo.</li>
</ul>

<p>Estos dos modos presentan una serie de inconvenientes: las operaciones <strong>TOI</strong> bloquean todo el grupo durante el cambio de esquema mientras que las
<strong>RSU</strong> pueden dejar el grupo en un estado inconsistente si el <em>binary log</em> en formato <code>ROW</code> no es compatible entre esquemas.</p>

<p>Respecto al uso de herramientas de terceros, <code>Galera</code> tiene una serie de
<a href="https://www.fromdual.com/limitations-of-galera-cluster">limitaciones</a> entre las que se encuentra el no soporte al bloqueo de tablas, operaci贸n necesaria en las herramientas <code>OnlineSchemaChange</code> y <code>gh-ost</code> para aplicar los 煤ltimos eventos debido a su naturaleza as铆ncrona, problema que no tiene <code>pt-osc</code> debido a que es s铆ncrono debido al uso de <em>triggers</em>.</p>

<p>A pesar que <code>pt-osc</code> es compatible con <code>Galera</code>, el uso de <em>triggers</em> presenta una serie de riesgos debido a que no es
posible parar por completo la operaci贸n en caso de necesidad y que el uso de <em>triggers</em> a帽aden una carga extra a la base de datos. Por ello, para permitir usar <code>gh-ost</code> en <code>Galera</code>, es necesario investigar por qu茅 necesita el uso de <code>LOCK TABLES</code> y buscar un planteamiento alternativo.</p>

<h3 id="gh-ost">gh-ost</h3>

<p><a href="https://github.com/github/gh-ost"><em>gh-ost</em></a> es la herramienta de GitHub para la aplicaci贸n de cambios de esquema en
l铆nea y
tiene interesantes ventajas respecto a otras herramientas existentes. Una de sus caracter铆sticas principales es que no usa
<em>triggers</em> para sincronizar los cambios de la tabla original con la tabla fantasma<sup class="footnote-ref" id="fnref-3"><a href="#fn-3">3</a></sup> si no los <em>binlogs</em> de <em>MySQL</em> y, por ello, permite verdaderamente parar totalmente la migraci贸n en caso de necesidad.</p>

<div class="columns"> <div class="column is-8-mobile is-offset-2-mobile is-6-tablet is-offset-3-tablet"> <div class="post-image-container"> <div class="image post-image"> <div class="lazy-hide lazy-container"> <img alt="El logo de gh-ost" class="lazy lazy-blur" data-srcset="/blog-test/img/blog/2019-05-12-why-dont-you-see-ghosts-in-galeras/gh-ost.190px.png 190w, /blog-test/img/blog/2019-05-12-why-dont-you-see-ghosts-in-galeras/gh-ost.480px.png 480w, /blog-test/img/blog/2019-05-12-why-dont-you-see-ghosts-in-galeras/gh-ost.674px.png 1348w, /blog-test/img/blog/2019-05-12-why-dont-you-see-ghosts-in-galeras/gh-ost.836px.png 4180w, /blog-test/img/blog/2019-05-12-why-dont-you-see-ghosts-in-galeras/gh-ost.975px.png 4875w, /blog-test/img/blog/2019-05-12-why-dont-you-see-ghosts-in-galeras/gh-ost.1109px.png 5545w" data-src="/blog-test/img/blog/2019-05-12-why-dont-you-see-ghosts-in-galeras/gh-ost.190px.png" src="/blog-test/img/blog/2019-05-12-why-dont-you-see-ghosts-in-galeras/gh-ost.preview.png" /> </div> <noscript> <div class="lazy-container"> <img alt="El logo de gh-ost" class="" srcset="/blog-test/img/blog/2019-05-12-why-dont-you-see-ghosts-in-galeras/gh-ost.190px.png 190w, /blog-test/img/blog/2019-05-12-why-dont-you-see-ghosts-in-galeras/gh-ost.480px.png 480w, /blog-test/img/blog/2019-05-12-why-dont-you-see-ghosts-in-galeras/gh-ost.674px.png 1348w, /blog-test/img/blog/2019-05-12-why-dont-you-see-ghosts-in-galeras/gh-ost.836px.png 4180w, /blog-test/img/blog/2019-05-12-why-dont-you-see-ghosts-in-galeras/gh-ost.975px.png 4875w, /blog-test/img/blog/2019-05-12-why-dont-you-see-ghosts-in-galeras/gh-ost.1109px.png 5545w" src="/blog-test/img/blog/2019-05-12-why-dont-you-see-ghosts-in-galeras/gh-ost.190px.png" /> </div> </noscript> </div> <div class="image-caption">El logo de gh-ost</div> </div>  </div> </div>

<p>La raz贸n que impide usar <code>gh-ost</code> con <code>Galera</code> es que, para poder hacer la etapa de <a href="https://github.com/github/gh-ost/blob/master/doc/cut-over.md"><em>cut-over</em></a>, <code>gh-ost</code> hace uso de la instrucci贸n <a href="https://dev.mysql.com/doc/refman/8.0/en/lock-tables.html">lock</a>, instrucci贸n no est谩 soportada en <code>Galera</code>. </p>

<h4 id="cut-over">Cut-over</h4>

<p>En la documentaci贸n de <code>gh-ost</code> la etapa de <em>cut-over</em> se define como <code>the final major step of the migration</code> y su objetivo
es reemplazar la tabla fantasma por la tabla original. Para dicho prop贸sito, es necesario que ambas tablas tengan
aplicados los mismos registros a la hora de realizar el intercambio o, de lo contrario, se perder铆an datos en el proceso de
migraci贸n.</p>

<p>A diferencia de otras herramientas de cambios de esquema en linea como <code>pt-osc</code>, <code>gh-ost</code> no delega en la base de datos la aplicaci贸n de los
registros modificados durante la migraci贸n y, por ello, necesita bloquear moment谩neamente los cambios en la tabla original hasta que se
apliquen todos los cambios pendientes del <em>binlog</em>, es ah铆 donde es necesario el uso de la operaci贸n <em>lock</em> en la tabla
original.</p>

<h4 id="_lock-tables_"><em>LOCK TABLES</em></h4>

<p>El primer enfoque que puede venir a la cabeza es que aunque la operaci贸n <em>lock</em> en <code>Galera</code> no permite bloquear el acceso a una tabla en todos los
nodos at贸micamente si que acepta bloquear los accesos de un nodo en particular, por lo que podr铆a
ser posible aplicar el <code>LOCK TABLES</code> manualmente en todos los nodos. Tras algo de investigaci贸n y un par de pruebas dicho enfoque queda
descartado por varias razones:</p>

<ul>
<li>El algoritmo de <em>cut-over</em> at贸mico de <code>gh-ost</code> necesita el uso de varias conexiones independientes para funcionar y aunque garantiza dejar el grupo en un estado consistente en el caso de que ocurran errores en las conexiones, dicha premisa deja de ser cierta si se tiene que aplicar un <code>LOCK TABLES</code> por cada nodo. Si quieres saber c贸mo
funciona la estrategia de <em>gh-ost</em> para aplicar el <em>cut-over</em> at贸mico te recomiendo que leas el <a href="https://github.com/github/gh-ost/issues/82"><em>Issue #82</em></a>.</li>
<li>Como se puede ver en <a href="https://jira.mariadb.org/browse/MDEV-12647">MDEV-12647</a>, es bastante probable dejar alguno de los nodos colgado al usar el <code>LOCK TABLES</code> en cada nodo.</li>
</ul>

<p>Por ello el uso del <code>LOCK TABLES</code> queda descartado y es necesario analizar otras soluciones existentes para la realizaci贸n de
migraciones de esquema sin p茅rdida de servicio y que si permiten su uso con <code>Galera</code>, es ah铆 donde entra en juego <code>pt-osc</code>.</p>

<div class="columns"> <div class="column is-8-mobile is-offset-2-mobile is-6-tablet is-offset-3-tablet"> <div class="post-image-container"> <div class="image post-image"> <div class="lazy-hide lazy-container"> <img alt="Hombre pensando" class="lazy lazy-blur" data-srcset="/blog-test/img/blog/2019-05-12-why-dont-you-see-ghosts-in-galeras/brainstorming.190px.jpg 190w, /blog-test/img/blog/2019-05-12-why-dont-you-see-ghosts-in-galeras/brainstorming.480px.jpg 480w, /blog-test/img/blog/2019-05-12-why-dont-you-see-ghosts-in-galeras/brainstorming.674px.jpg 1348w, /blog-test/img/blog/2019-05-12-why-dont-you-see-ghosts-in-galeras/brainstorming.836px.jpg 4180w, /blog-test/img/blog/2019-05-12-why-dont-you-see-ghosts-in-galeras/brainstorming.975px.jpg 4875w, /blog-test/img/blog/2019-05-12-why-dont-you-see-ghosts-in-galeras/brainstorming.1109px.jpg 5545w" data-src="/blog-test/img/blog/2019-05-12-why-dont-you-see-ghosts-in-galeras/brainstorming.190px.jpg" src="/blog-test/img/blog/2019-05-12-why-dont-you-see-ghosts-in-galeras/brainstorming.preview.png" /> </div> <noscript> <div class="lazy-container"> <img alt="Hombre pensando" class="" srcset="/blog-test/img/blog/2019-05-12-why-dont-you-see-ghosts-in-galeras/brainstorming.190px.jpg 190w, /blog-test/img/blog/2019-05-12-why-dont-you-see-ghosts-in-galeras/brainstorming.480px.jpg 480w, /blog-test/img/blog/2019-05-12-why-dont-you-see-ghosts-in-galeras/brainstorming.674px.jpg 1348w, /blog-test/img/blog/2019-05-12-why-dont-you-see-ghosts-in-galeras/brainstorming.836px.jpg 4180w, /blog-test/img/blog/2019-05-12-why-dont-you-see-ghosts-in-galeras/brainstorming.975px.jpg 4875w, /blog-test/img/blog/2019-05-12-why-dont-you-see-ghosts-in-galeras/brainstorming.1109px.jpg 5545w" src="/blog-test/img/blog/2019-05-12-why-dont-you-see-ghosts-in-galeras/brainstorming.190px.jpg" /> </div> </noscript> </div> <div class="image-caption">Hombre pensando. Imagen de <a href="https://www.pexels.com/@startup-stock-photos">Startup Stock Photos</a></div> </div>  </div> </div>

<h3 id="pt-osc">pt-osc</h3>

<p><a href="https://www.percona.com/doc/percona-toolkit/3.0/pt-online-schema-change.html"><em>pt-osc</em></a> es una herramienta de Percona que permite realizar migraciones de esquemas sin p茅rdida de servicio compatible con <code>Galera</code> y que se basa en delegar en la base de datos la copia los datos modificados durante la migraci贸n mediante <em>triggers</em>, de esta forma se asegura que los cambios de la tabla original est茅n sincronizados con la tabla fantasma. Si quieres saber como asegura la consistencia te recomiendo que leas esta respuesta de <a href="https://dba.stackexchange.com/a/93515">StackExchange</a>.</p>

<div class="columns"> <div class="column is-8-mobile is-offset-2-mobile is-6-tablet is-offset-3-tablet"> <div class="post-image-container"> <div class="image post-image"> <div class="lazy-hide lazy-container"> <img alt="El logo de percona toolkit" class="lazy lazy-blur" data-srcset="/blog-test/img/blog/2019-05-12-why-dont-you-see-ghosts-in-galeras/percona_toolkit.190px.jpg 190w, /blog-test/img/blog/2019-05-12-why-dont-you-see-ghosts-in-galeras/percona_toolkit.480px.jpg 480w, /blog-test/img/blog/2019-05-12-why-dont-you-see-ghosts-in-galeras/percona_toolkit.674px.jpg 1348w, /blog-test/img/blog/2019-05-12-why-dont-you-see-ghosts-in-galeras/percona_toolkit.836px.jpg 4180w, /blog-test/img/blog/2019-05-12-why-dont-you-see-ghosts-in-galeras/percona_toolkit.975px.jpg 4875w, /blog-test/img/blog/2019-05-12-why-dont-you-see-ghosts-in-galeras/percona_toolkit.1109px.jpg 5545w" data-src="/blog-test/img/blog/2019-05-12-why-dont-you-see-ghosts-in-galeras/percona_toolkit.190px.jpg" src="/blog-test/img/blog/2019-05-12-why-dont-you-see-ghosts-in-galeras/percona_toolkit.preview.png" /> </div> <noscript> <div class="lazy-container"> <img alt="El logo de percona toolkit" class="" srcset="/blog-test/img/blog/2019-05-12-why-dont-you-see-ghosts-in-galeras/percona_toolkit.190px.jpg 190w, /blog-test/img/blog/2019-05-12-why-dont-you-see-ghosts-in-galeras/percona_toolkit.480px.jpg 480w, /blog-test/img/blog/2019-05-12-why-dont-you-see-ghosts-in-galeras/percona_toolkit.674px.jpg 1348w, /blog-test/img/blog/2019-05-12-why-dont-you-see-ghosts-in-galeras/percona_toolkit.836px.jpg 4180w, /blog-test/img/blog/2019-05-12-why-dont-you-see-ghosts-in-galeras/percona_toolkit.975px.jpg 4875w, /blog-test/img/blog/2019-05-12-why-dont-you-see-ghosts-in-galeras/percona_toolkit.1109px.jpg 5545w" src="/blog-test/img/blog/2019-05-12-why-dont-you-see-ghosts-in-galeras/percona_toolkit.190px.jpg" /> </div> </noscript> </div> <div class="image-caption">El logo de percona toolkit</div> </div>  </div> </div>

<h3 id="solucion-planteada">Soluci贸n planteada</h3>

<p>Por lo tanto, si es posible realizar una migraci贸n consistente mediante <em>triggers</em> tal vez sea posible utilizarlos aunque solo sea para la etapa de <em>cut-over</em>. Para ello es posible plantear una nueva estrategia de <em>cut-over</em> cuyo procedimiento es el siguiente:</p>

<ul>
<li>A la hora de empezar el <em>cut-over</em> se inyecta un evento en el <em>binlog</em> para notificar a <code>gh-ost</code> de que deje de
escribir los nuevos registros en la tabla fantasma pero que siga ley茅ndolos del <em>binlog</em>.</li>
<li>Una vez recibido el evento <code>gh-ost</code> deja de aplicar los eventos pero almacena los valores seg煤n la clave 煤nica usada
durante la migraci贸n.</li>
<li>Se crean los <em>triggers</em> necesarios para sincronizar los nuevos registros entre la tabla original y la fantasma.</li>
<li>Se inyecta un nuevo evento en el <em>binlog</em> para notificar que los <em>triggers</em> se han creado.</li>
<li>Una vez recibido este segundo evento se dejan de leer el <em>binlog</em> y por consiguiente, tambi茅n de guardar los valores seg煤n la clave 煤nica.</li>
<li>Los registros ocurridos entre ambos eventos pueden ser inconsistentes dado que ha dejado de aplicarse los eventos del
<em>binlog</em>. Para solucionar dicho problema se realiza una etapa de saneamiento que consiste en eliminarlos de la tabla fantasma si existen e insertarlos de nuevo desde la tabla original.</li>
<li>Una vez se haya saneado los eventos, ambas tablas son consistentes, por lo que es posible usar la
operaci贸n <code>RENAME TABLE</code> para intercambiar la tabla original con la fantasma de una manera at贸mica.</li>
<li>Tras dicha operaci贸n o en el caso de fallo se eliminan los <em>triggers</em>.</li>
</ul>

<h3 id="resultados-y-conclusion">Resultados y conclusi贸n</h3>

<p>Una vez planteada una soluci贸n he implementado los cambios necesarios el c贸digo de <code>gh-ost</code> y despu茅s de un par de
semanas de pruebas hemos empezado a usarlo en producci贸n con unos muy buenos resultados, por lo que he creado la <em>pull request</em> <a href="https://github.com/github/gh-ost/pull/780">#780</a>.</p>

<p>Respecto a la conclusi贸n, aunque <code>gh-ost</code> se considere <em>triggerless</em>, la vida de los <em>triggers</em> necesarios ser谩 igual a lo que tarde en aplicarse los cambios pendientes del <em>binlog</em> y sanear las entradas que puedan ser inconsistentes, que ser谩 de apenas unos segundos en el peor de los casos, por lo que se considera aceptable.</p>

<div class="footnotes">
<hr />
<ol>
<li id="fn-1">
<p><em>Total Order Isolation</em>.&#160;<a href="#fnref-1" class="footnoteBackLink" title="Volver a la nota a pie de p谩gina 1 del texto.">&#8617;</a></p>
</li>

<li id="fn-2">
<p><em>Rolling Schema Upgrade</em>.&#160;<a href="#fnref-2" class="footnoteBackLink" title="Volver a la nota a pie de p谩gina 2 del texto.">&#8617;</a></p>
</li>

<li id="fn-3">
<p>Con tabla fantasma me refiero a la tabla donde se ha aplicado los cambios de esquema y que es necesario rellenar con los datos de la original.&#160;<a href="#fnref-3" class="footnoteBackLink" title="Volver a la nota a pie de p谩gina 3 del texto.">&#8617;</a></p>
</li>
</ol>
</div>

</div>

      </div>
    </div>
  </div>
</section>
<!-- END ARTICLE FEED -->

        </div>
      </div>

      <footer class="footer">
        <div class="content has-text-centered">
          <p>漏 Juan Manuel Fdez 2020. Hecho con curiosidad, caf茅 y neovim.</p>
          <div>
            <a href="/blog-test/es/rss.xml">
              <span class="icon">
                <i class="fas fa-rss"></i>
              </span>
              <span>RSS</span>
            </a>
          </div>
        </div>
      </footer>
    </div>

    <!-- Bootstrap core JavaScript -->
    <script defer src="/blog-test/vendor/jquery/jquery.min.js"></script>

    <!-- Plugin JavaScript -->
    <script defer src="/blog-test/vendor/jquery-easing/jquery.easing.min.js"></script>
    <script defer src="/blog-test/vendor/jquery-lazy/jquery.lazy.min.js"></script>

    <!-- Custom scripts for this template -->
    <script defer src="/blog-test/js/main.min.js"></script>
  </body>
</html>